<!doctype html>
<html style="height:100%">
<head>
    <link rel="stylesheet" href="http://xa-tools-hornet/css/site.css" type="text/css">
    <link rel="stylesheet" href="http://xa-tools-hornet/css/spreadgrid.css" type="text/css">
    <script src="http://xa-tools-hornet/grunt-scripts/lodash.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/jquery.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/spreadgrid.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/globalize.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/formatter.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/functions.js"></script>

    <style>
        .grid {
            height: 100%;
        }

        .header-cell {
            height: 100%;
            position: absolute;
            font-weight: 700;
            border-right: 1px solid rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(0, 0, 0, 0.2);
        }

        .gc-grouping-toggle {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAwCAYAAAAYX/pXAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAADoSURBVEhLvZXRDoIwEAT9chOf/Gx0gXLU2dIeECdZCOPtvvqYpulSrMzEykyWxwn+NvBeA0YGVNSPCkZ6A/tySTVyNODKJdtIa+CoXDKPtAaGqQauxMpMrMzEykyszMTKTCg64B6iA+4hguf6rsA9RKAPjOAeItAHRnAPEZSBagT3EMF+QJlHcA8R7MvK6xveQwQoC9xDBCgL3EMEKAvcQwQoC9xDdMD9r8jGykyszMTKTKzMxMpMrMxkeZygNXDLn+vRyFwWRwPCjWxl0RsQ+5GqLEYGhIooi9GBJvcOXImVmVg5nunxAYlCnj9c93xwAAAAAElFTkSuQmCC');
            display: inline-block;
            width: 18px;
            height: 18px;
            vertical-align: middle;
            margin-right: 6px;
            border: 0;
        }

            .gc-grouping-toggle.expand {
                background-position: -0px -32px;
            }

            .gc-grouping-toggle.collapsed {
                background-position: -0px -16px;
            }
    </style>
</head>
<body style="height:95%;">

    <div id="grid1" class="grid">
    </div>


    <script>
        var gcGrid;
        var columns = [
            { id: 'productName', caption: 'Product Name', dataField: 'productName', width: 180 },
            { id: 'salesMan', caption: 'salesMan', dataField: 'salesMan', width: 180 },
            { id: "unitPrice", caption: "Unit Price", dataField: "unitPrice", format: '$#,##0', width: 180 },
            {
                id: 'quantity',
                caption: 'quantity',
                dataField: 'quantity',
                aggregation: {
                    formula: 'sum([quantity])',
                    presenter: 'total: {{=it.__agg_quantity}}'
                },
                width: 120
            },
            {
                id: 'sales',
                caption: 'sales',
                dataField: '=[unitPrice] * [quantity]',
                aggregation: {
                    formula: 'sum([sales])',
                    presenter: 'total: {{=it.__agg_sales}}'
                },
                width: 120
            }
        ];

        $.getJSON("databases/salesData_small.json", function (data) {
            gcGrid = new GcSpread.Views.GcGrid(document.getElementById('grid1'), data, columns,
            {
                showRowHeader: false,
                allowGrouping: false,
                grouping: [
                    {
                        field: 'salesMan',
                        header: {
                            template: '<div class="header-cell" style="width:540px;"><span class="gc-grouping-toggle {{=it.groupStatus}}" style="margin-left:{{=it.margin+4}}px;"></span><span level="{{=it.level}}">{{=it.name}} ({{=it.count}} items)</span></div><div class="header-cell" style="right:0px;width:120px;">{{=it.__agg_sales}}</div><div class="header-cell" style="right:120px;width:120px;">{{=it.__agg_quantity}}</div>'
                        },
                        footer: {
                            visible: false
                        },
                        collapsed: true
                    },
                    {
                        field: 'productName',
                    }
                ]
            });
        });
    </script>


</body>
</html>
