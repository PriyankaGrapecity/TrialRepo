<!doctype html>
<html style="height:100%">
<head>
    <link rel="stylesheet" href="http://xa-tools-hornet/css/site.css" type="text/css">
    <link rel="stylesheet" href="http://xa-tools-hornet/css/spreadgrid.css" type="text/css">
    <script src="http://xa-tools-hornet/grunt-scripts/lodash.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/jquery.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/spreadgrid.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/globalize.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/formatter.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/functions.js"></script>

    <style>
        .grid {
            height: 100%;
        }

        .percent-complete-bar {
            display: inline-block;
            height: 6px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }
    </style>
</head>
<body style="height:95%;">

    <div id="grid1" class="grid">
    </div>


    <script>
        var gcGrid;
        var columns = [
               { id: 'productName', caption: 'productName', dataField: 'productName' },
               { id: 'salesMan', caption: 'salesMan', dataField: 'salesMan' },
               {
                   id: 'quantity',
                   caption: 'quantity',
                   dataField: 'quantity',
                   groupHeader: 'quantity: {{=it.eval("=sum([quantity])")}}',
                   groupFooter: 'average:{{=it.eval("=average([quantity])", "#.##")}}'
               },
               { id: 'unitPrice', caption: 'unitPrice', dataField: 'unitPrice' },
               { id: 'country', caption: 'country', dataField: 'country' },
               { id: 'region', caption: 'region', dataField: 'region' },
               {
               //#region agg
                   id: 'sales',
                   caption: 'sales',
                   dataField: '=[unitPrice] * [quantity]',
                   groupHeader: 'percent: {{=it.eval("=sum([sales]) / sumx(parentgroup(), [sales])", "0.0%")}}',
                   groupFooter: 'average: {{=it.eval("=average([sales])", "$#,##.##")}}',
                   width: 150
                   //#endregion
               }
        ];

        $.getJSON("database/salesData_small.json", function (data) {
            var gcGrid = new GcSpread.Views.GcGrid(document.getElementById('grid1'), data, columns, {
                allowEditing: true
            });
            gcGrid.data.groupDescriptors = [{ field: 'region', collapsed: false }, { field: 'country', collapsed: true }];
        });
    </script>


</body>
</html>
