<!doctype html>
<html style="height:100%">
<head>
    <link rel="stylesheet" href="http://xa-tools-hornet/css/site.css" type="text/css">
    <link rel="stylesheet" href="http://xa-tools-hornet/css/spreadgrid.css" type="text/css">
    <script src="http://xa-tools-hornet/grunt-scripts/lodash.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/jquery.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/spreadgrid.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/globalize.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/formatter.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/functions.js"></script>

    <style>
        .grid {
            height: 100%;
        }

        .edit-btn {
            width: 70px;
            margin: 0 3px;
        }

        .dialog-overlay {
            position: fixed;
            left: 0;
            top: 0;
            opacity: 0.5;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 9999;
        }

        .dialog-container {
            position: absolute;
            background: white;
            z-index: 10000;
            border: 1px solid lightgrey;
            border-radius: 4px;
            width: 300px;
            height: 200px;
        }

        .dialog-header {
            background: lightgray;
            padding: 5px;
        }

        .dialog-body {
            padding: 10px 0 0 15px;
        }

        .dialog-close-button {
            float: right;
            width: 20px;
            text-align: center;
            border-radius: 10px;
        }

            .dialog-close-button:hover {
                cursor: pointer;
                background: darkgray;
            }

        .gc-selected {
            background-color: #E13300;
            color: #fff;
        }
    </style>
</head>
<body style="height:95%;">

    <div id="grid1" class="grid"></div>
    <template id='editRowTemplate'>
        <div>
            <div class='edit-detail'>
                <label class='column1'>First Name</label>
                <input class='column2' data-column="firstName" />
                <label class='column1'>Last Name</label>
                <input class='column2' data-column="lastName" />
            </div>
            <div class='edit-detail'>
                <label class='column1'>Score</label>
                <input class='column2' data-column="score" />
                <label class='column1'>Apply</label>
                <select class='column2' data-column="apply">
                    <option>Sales</option>
                    <option>Sales Manager</option>
                    <option>Web Developer</option>
                    <option>.NET Developer</option>
                    <option>Admin Assistant</option>
                </select>
            </div>
            <div class='edit-advantage edit-detail'>
                <label class='column1'>Advantage</label>
                <textarea data-column="advantage"></textarea>
            </div>
        </div>
    </template>


    <script>
        var columns = [
               { id: 'firstName', caption: 'First Name', dataField: 'firstName', width: 100 },
               { id: 'lastName', caption: 'Last Name', dataField: 'lastName', width: 100 },
               { id: 'score', caption: 'Score', dataField: 'score', width: 100, dataType: 'number' },
               { id: 'apply', caption: 'Apply', dataField: 'apply', width: 160 },
               {
                   id: 'controlPanel1',
                   action: [
                       {
                           name: 'touchedit',
                           presenter: '<div data-action = "touchedit" style = "background-color:#603DFD;color:white;width:80px;height:100%;position:relative"><span style = "position:absolute;left:35%;top:25%">Edit</span></div>',
                           handler: startEdit
                       }
                   ],
                   width: 80,
                   swipeDirection: 'left'
               },
               {
                   id: 'controlPanel2',
                   action: [
                       {
                           name: 'select',
                           presenter: '<div data-action = "select" style = "background-color:#837E50;color:white;width:80px;height:100%;position:relative"><span style = "position:absolute;left:35%;top:25%">Select</span></div>',
                           handler: selectRow
                       }
                   ],
                   width: 80,
                   swipeDirection: 'left'
               },
               {
                   id: 'controlPanel3',
                   action: [
                       {
                           name: 'detail',
                           presenter: '<div data-action = "detail" style = "background-color:#FD6345;color:white;width:80px;height:100%;position:relative"><span style = "position:absolute;left:35%;top:25%">Detail</span></div>',
                           handler: showDetails
                       }
                   ],
                   width: 80,
                   swipeDirection: 'left'
               },
               {
                   id: 'controlPanel4',
                   action: [
                       {
                           name: 'delete',
                           presenter: '<div  data-action = "delete" style = "background-color:red;color:white;width:80px;height:100%;position:relative"><span style = "position:absolute;left:35%;top:25%">Delete</span></div>',
                           handler: deleteRow,
                           flickAction: 'left'
                       }
                   ],
                   width: 80,
                   swipeDirection: 'right'
               },
        ];

        function showDetails(args) {
            initDialog(args);
        };

        function startEdit(args) {
            args.closeActionColumnPanel();
            args.gridModel.startEditing();
        }

        function selectRow(args) {
            args.closeActionColumnPanel();
        }

        function deleteRow(args) {
            var answer = confirm('Are you sure to delete row?');
            if (answer) {
                var souceCollection = gcGrid1.data.sourceCollection;
                souceCollection.splice(souceCollection.indexOf(args.dataItem), 1);
                gcGrid1.invalidate();
            }

            args.closeActionColumnPanel();
        }

        var gcGrid1;
        $.getJSON("data/resume.json", function (data) {
            gcGrid1 = new GcSpread.Views.GcGrid(document.getElementById('grid1'), data, columns, {
                rowHeight: 40,
                allowEditing: true,
                allowSwipe: true,
                editMode: 'editForm'
            });
        })

        function initDialog(args) {
            var dataItem = args.dataItem;
            var overlay = $('<div class="dialog-overlay"></div>');
            var dialogContainer = $('<div class="dialog-container"></div>');
            var dialog = $('<div class="dialog-header"><span style="font-weight:bold">Applicant Details</span><div class="dialog-close-button"><span>&#x2715</span></div></div>' +
            '<div class="dialog-body">' +
            '<div style="font-size:20px;font-weight:bold;">' + dataItem.firstName + ' ' + dataItem.lastName + '</div>' +
            '<div style="font-style:italic">' + dataItem.apply + '</div>' +
            '<div style="margin-top:15px;">' + dataItem.advantage + '</div></div>');
            dialogContainer.append(dialog);
            $(document.body).append(overlay).append(dialogContainer);
            overlay.on('mousewheel', function () {
                return false;
            })
            $('.dialog-close-button').on('click', function () {
                overlay.remove();
                dialogContainer.remove();
                args.closeActionColumnPanel();
            })

            var screenWindow = $(window);
            var left = parseInt((screenWindow.width() - dialogContainer.width()) / 2 + window.pageXOffset);
            var top = parseInt((screenWindow.height() - dialogContainer.height()) / 2 + window.pageYOffset);
            dialogContainer.css({
                left: left,
                top: top
            });
        };
    </script>


</body>
</html>
