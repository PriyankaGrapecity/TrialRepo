<!doctype html>
<html style="height:100%">
<head>
    <link rel="stylesheet" href="http://xa-tools-hornet/css/site.css" type="text/css">
    <link rel="stylesheet" href="http://xa-tools-hornet/css/spreadgrid.css" type="text/css">
    <script src="http://xa-tools-hornet/grunt-scripts/lodash.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/jquery.min.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/spreadgrid.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/globalize.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/formatter.js"></script>
    <script src="http://xa-tools-hornet/grunt-scripts/functions.js"></script>
    <script src="scripts/sparkline.js"></script>

    <style>
        .grid {
            height: 100%;
        }
    </style>
</head>
<body style="height:95%;">

    <div id="grid1" class="grid"></div>


    <script>
        //#region spark
        var standard = 10.5;

        function renderWinlosssparkline(data, container) {
            var newData = [];
            for (var i = 0, length = data.lastSixMonths.length; i < length; i++) {
                newData.push(data.lastSixMonths[i] - standard);
            }
            var winlossSparkline = new GcSpread.Views.GcGrid.Plugins.Sparkline.WinlossSparkline({
                values: newData,
                setting: {
                    axisColor: 'lightgrey',
                    markersColor: 'yellow',
                    negativeColor: 'red',
                    seriesColor: 'black',
                    displayXAxis: true,
                    showFirst: true,
                    showHigh: true,
                    showLast: true,
                    showLow: true,
                    showNegative: true,
                    showMarkers: true
                }
            });
            winlossSparkline.paint(container);
        }

        var lineSparklineSetting = {
            highMarkerColor: 'green',
            lowMarkerColor: 'red',
            markersColor: 'black',
            seriesColor: 'lightgrey',
            showMarkers: true,
            showHigh: true,
            showLow: true,
            lineWeight: 2,
            minAxisType: 2,
            maxAxisType: 2,
            manualMax: 25,
            manualMin: 0
        };

        var columnSparklineSettings = {
            highMarkerColor: 'green',
            lowMarkerColor: 'red',
            markersColor: 'black',
            seriesColor: 'lightgreen',
            showMarkers: true,
            showHigh: true,
            showLow: true,
            minAxisType: 2,
            maxAxisType: 2,
            manualMax: 25,
            manualMin: 0
        };

        var lineSparklineFormula = '=LINESPARKLINE([lastSixMonths], "", "' + JSON.stringify(lineSparklineSetting).replace(/\"/g, '') + '")';
        var columnSparklineFormula = '=COLUMNSPARKLINE([lastSixMonths], "", "' + JSON.stringify(columnSparklineSettings).replace(/\"/g, '') + '")';
        var pieSparklineFormula = '=PIESPARKLINE([goalPercent],"green","red")';

        var columns = [
               { id: 'salesMan', caption: 'SalesMan', dataField: 'salesMan', width: 90 },
               { id: 'productName', caption: 'Product', dataField: 'productName', width: 90 },
               { id: 'tend', caption: 'Tend(Six Months)', width: '2*', dataField: lineSparklineFormula },
               { id: 'sales', caption: 'Sales', width: '2*', dataField: columnSparklineFormula },
               { id: 'winloss', caption: 'Winloss', width: '2*', asyncRender: renderWinlosssparkline },
               { id: 'goal', caption: 'toGoal(%)', width: '2*', dataField: pieSparklineFormula },
               { id: 'lastSixMonths', dataField: 'lastSixMonths', visible: false }

        ];

        $.getJSON("data/salesData_statistics.json", function (data) {
            gcGrid = new GcSpread.Views.GcGrid(document.getElementById('grid1'), data, columns, {
                rowHeight: 60
            });
        });
        //#endregion
    </script>


</body>
</html>
