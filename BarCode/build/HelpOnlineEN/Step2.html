<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta http-equiv="X-UA-Compatible" value="IE=9" />

    <!--DXMETADATA start type="IsTemplateFileFeatureEnabled" name="Responsive" format="<meta name=""viewport"" content=""width=device-width, initial-scale=1.0"" />" --><meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--DXMETADATA end-->

    <!--DXMETADATA start type="Literal" condition="helpversion:value=3" value="<meta name=""Microsoft.Help.SelfBranded"" content=""true"" />" --><!--DXMETADATA end-->

    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>Step 2: Adding Code</title><!--DXMETADATA end-->
    <!--DXMETADATA start type="ItemTitle" format="<meta name=""Title"" content=""%%ItemTitleNoQuotes%%""/>" --><meta name="Title" content="Step 2: Adding Code"/><!--DXMETADATA end-->    
    
    <script src="script/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script"></script>
    <script src="script/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery-ui-1.8.18.custom.css" />
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery.qtip.css" />
	
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"" />" --><!--DXMETADATA end-->
	<!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->

    <!--DXMETADATA start type="Synopsis" StripHtmlTags="True" MaxLength="250" format="<meta name=""Description"" content=""%%Synopsis%%"" />"--><meta name="Description" content="In this step, you start by adding the interaction logic for the controls defined in the XAML markup." /><!--DXMETADATA end-->
    
    <link rel="styleSheet" type="text/css" href="stylesheets/topics.2012.css" data-mshv2-stylesheet="/stylesheets/topics.2012.mshv2.css" data-mshv1-stylesheet="/stylesheets/topics.2012.mshv1.css" />
    <script src="script/topics.jqueryplugins.2012.min.js" type="text/javascript"></script>
    <script src="script/topics.2012.js" type="text/javascript"></script>
    
    <!--DXMETADATA start type="TopicId" format="<meta name=""Microsoft.Help.Id"" content=""%%TopicId%%""/>" --><meta name="Microsoft.Help.Id" content="d807adc7-c6c2-4003-bafe-b92f6775358d"/><!--DXMETADATA end-->
    <!--DXMETADATA start type="TocParentId" format="<meta name=""Microsoft.Help.TocParent"" content=""%%TocParentId%%""/>" --><meta name="Microsoft.Help.TocParent" content="-1"/><!--DXMETADATA end-->
    <!--DXMETADATA start type="TocOrdinal" format="<meta name=""Microsoft.Help.TocOrder"" content=""%%TocOrdinal%%""/>" --><meta name="Microsoft.Help.TocOrder" content="2"/><!--DXMETADATA end-->
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    <!--DXMETADATA start type="MshvKeywords" condition="helpversion:value=3" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="MshvMetaTags" condition="helpversion:value=3" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Help3CatalogLocale" condition="helpversion:value=3" format="<meta name=""Microsoft.Help.Locale"" content=""%%Help3CatalogLocale%%"" />"--><!--DXMETADATA end-->
    <!--DXMETADATA start type="Help3CatalogLocale" condition="helpversion:value=3" format="<meta name=""Microsoft.Help.TopicLocale"" content=""%%Help3CatalogLocale%%"" />"--><!--DXMETADATA end-->
    
    <!--DXMETADATA start type="Stylesheets" --><link rel="styleSheet" type="text/css" href="stylesheets/slimbox2.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/hs-jquery-common.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/hs-jquery-slimbox.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/hs-jquery-expand.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/responsive.css"></link>
    <link rel="styleSheet" type="text/css" href="stylesheets/customstyles.css"></link><!--DXMETADATA end-->
    <!--DXMETADATA start type="Scripts" --><script src="script/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="script/slimbox2.js" type="text/javascript"></script>
    <script src="script/hs-jquery-common.js" type="text/javascript"></script>
    <script src="script/jquery-expand.js" type="text/javascript"></script>
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/jquery.fitvids.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/modernizr.custom.min.js" type="text/javascript"></script>
    <script src="script/responsive.js" type="text/javascript"></script>
    <script src="script/responsive.navigationheader.js" type="text/javascript"></script>
    <script src="script/responsive.topics.loader.js" type="text/javascript" Id="responsive-marker"></script><!--DXMETADATA end-->

    <!--DXMETADATA start type="DesignTime"--><!--DXMETADATA end-->
    <!--DXMETADATA start type="IsNew" format="<script type=""text/javascript"">isNew = true;</script>" --><!--DXMETADATA end-->

    <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->

    <!--DXMETADATA start type="CustomHeadContent" --><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-208280-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!--DXMETADATA end-->
</head>

<body>
    <div id="BeforeHeaderContent">
        
    </div>
    <div id="HeaderContent">
        <!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%" --><!--DXMETADATA end -->
            <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
            <div id="ProjectTitle"><!--DXMETADATA start type="ProjectTitle" -->BarCode for WPF <!--DXMETADATA end--></div>
        <div id="PageTitle"><div id="PageTitleText"><!--DXMETADATA start type="ItemTitle" -->Step 2: Adding Code<!--DXMETADATA end--></div></div>
    </div>
    <div id="AfterHeaderContent">
        <!-- Spacing --> <span id="ToggleAllSectionsLink" class="FunctionLink">
                <label id="CollapseAllLabel"><!--DXMETADATA start type="Phrase" name="COLLAPSE_ALL" -->Collapse All<!--DXMETADATA end--></label>
                <label id="ExpandAllLabel" style="display: none;"><!--DXMETADATA start type="Phrase" name="EXPAND_ALL" -->Expand All<!--DXMETADATA end--></label>
            </span><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><div class="BreadcrumbsContainer"><table><tr><td>
<a href="C1BarCodeforWPF.html">Barcode for WPF </a>
 > Getting Started
 > Quick Start: BarCode for WPF 
 > Step 2: Adding Code</td></tr></table></div><!--DXMETADATA end -->
    
    
    <div id="BodyContent">
        <!--DXMETADATA start type="TopicSection" name="BodyText"--><p>In this step, you start by adding the interaction logic for the controls defined in the&nbsp;XAML markup.</p>

<p>Complete the following steps to add code in the MainWindow.xaml.cs file.</p>

<ol>
    <li>Switch to the code view that is MainWindow.xaml.cs file and add the following namespace.

        <div class="TabContainer TabContainerWidget">
            <ul>
                <li class="FilteredContentVB"><a href="#TabContent-VB">Visual Basic</a></li>

                <li class="FilteredContentCS"><a href="#TabContent-CS">C#</a></li>
            </ul>

            <div id="TabContent-VB" class="FilteredContentVB">
                <div class="FilteredContentVB TabContainer TabContainerWidget" data-title="Visual Basic" data-itemid="VB">
                    <ul>
                        <li><a href="#TabContent-c108c392-754a-4ef9-882f-e04ee5d2e1ca">Visual Basic</a></li>
                    </ul>

                    <div id="TabContent-c108c392-754a-4ef9-882f-e04ee5d2e1ca" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">Imports</span> C1.BarCode
</pre>
                    </div>
                </div>
            </div>

            <div id="TabContent-CS" class="FilteredContentCS">
                <div class="FilteredContentCS TabContainer TabContainerWidget" data-title="C#" data-itemid="CS">
                    <ul>
                        <li><a href="#TabContent-933c17eb-8511-41a0-b6b2-22cac2693e59">C#</a></li>
                    </ul>

                    <div id="TabContent-933c17eb-8511-41a0-b6b2-22cac2693e59" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">using</span> C1.BarCode;
</pre>
                    </div>
                </div>
            </div>
        </div>
    </li>

    <li>Subscribe the following events within the class constructor, that is the MainWindow() constructor, one by one and&nbsp;press <strong>TAB</strong> key every time to generate event handlers for each of the subscribed event.

        <div class="TabContainer TabContainerWidget">
            <ul>
                <li class="FilteredContentVB"><a href="#TabContent-VB">Visual Basic</a></li>

                <li class="FilteredContentCS"><a href="#TabContent-CS">C#</a></li>
            </ul>

            <div id="TabContent-VB" class="FilteredContentVB">
                <div class="FilteredContentVB TabContainer TabContainerWidget" data-title="Visual Basic" data-itemid="VB">
                    <ul>
                        <li><a href="#TabContent-c82e3da7-d8f8-4e1a-80d9-a6778c9b1f47">Visual Basic</a></li>
                    </ul>

                    <div id="TabContent-c82e3da7-d8f8-4e1a-80d9-a6778c9b1f47" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">AddHandler</span> <span style="COLOR: #0000ff">Me</span>.Loaded, <span style="COLOR: #0000ff">AddressOf</span> MainWindow_Loaded
<span style="COLOR: #0000ff">AddHandler</span> cbCodeType.SelectionChanged, <span style="COLOR: #0000ff">AddressOf</span> cbCodeType_SelectionChanged
<span style="COLOR: #0000ff">AddHandler</span> text.TextChanged, <span style="COLOR: #0000ff">AddressOf</span> text_TextChanged
</pre>
                    </div>
                </div>
            </div>

            <div id="TabContent-CS" class="FilteredContentCS">
                <div class="FilteredContentCS TabContainer TabContainerWidget" data-title="C#" data-itemid="CS">
                    <ul>
                        <li><a href="#TabContent-9051d75e-8634-4be6-9a50-c1f193ad2261">C#</a></li>
                    </ul>

                    <div id="TabContent-9051d75e-8634-4be6-9a50-c1f193ad2261" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">this</span>.Loaded += MainWindow_Loaded;
cbCodeType.SelectionChanged += cbCodeType_SelectionChanged;
text.TextChanged += text_TextChanged;
</pre>
                    </div>
                </div>
            </div>
        </div>
    </li>

    <li>Add the following code to the <strong>MainWindow_Loaded</strong> event handler created in the above step. This code loads the BarCode control as soon as the MainWindow gets loaded.

        <div class="TabContainer TabContainerWidget">
            <ul>
                <li class="FilteredContentVB"><a href="#TabContent-VB">Visual Basic</a></li>

                <li class="FilteredContentCS"><a href="#TabContent-CS">C#</a></li>
            </ul>

            <div id="TabContent-VB" class="FilteredContentVB">
                <div class="FilteredContentVB TabContainer TabContainerWidget" data-title="Visual Basic" data-itemid="VB">
                    <ul>
                        <li><a href="#TabContent-9da1d72f-7bf9-4ac0-aa15-5dcf8b915433">Visual Basic</a></li>
                    </ul>

                    <div id="TabContent-9da1d72f-7bf9-4ac0-aa15-5dcf8b915433" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">Private</span> <span style="COLOR: #0000ff">Sub</span> MainWindow_Loaded(sender <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Object</span>, e <span style="COLOR: #0000ff">As</span> RoutedEventArgs)
    cbCodeType.ItemsSource = [<span style="COLOR: #0000ff">Enum</span>].GetValues(<span style="COLOR: #0000ff">GetType</span>(CodeType))
    cbCodeType.SelectedItem = barcode.CodeType
<span style="COLOR: #0000ff">End Sub</span>
</pre>
                    </div>
                </div>
            </div>

            <div id="TabContent-CS" class="FilteredContentCS">
                <div class="FilteredContentCS TabContainer TabContainerWidget" data-title="C#" data-itemid="CS">
                    <ul>
                        <li><a href="#TabContent-b86a4c14-b6dc-434a-bf92-373fdbcc6879">C#</a></li>
                    </ul>

                    <div id="TabContent-b86a4c14-b6dc-434a-bf92-373fdbcc6879" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">void</span> MainWindow_Loaded(<span style="COLOR: #0000ff">object</span> sender, RoutedEventArgs e)
{
    cbCodeType.ItemsSource = Enum.GetValues(<span style="COLOR: #0000ff">typeof</span>(CodeType));
    cbCodeType.SelectedItem = barcode.CodeType;
}
</pre>
                    </div>
                </div>
            </div>
        </div>
    </li>

    <li>Add the following code to the <strong>cbCodeType_SelectionChanged</strong> event handler created in Step 2. This code changes the type of BarCode that appears on the MainWindow when the user changes the selection in the ComboBox control.

        <div class="TabContainer TabContainerWidget">
            <ul>
                <li class="FilteredContentVB"><a href="#TabContent-VB">Visual Basic</a></li>

                <li class="FilteredContentCS"><a href="#TabContent-CS">C#</a></li>
            </ul>

            <div id="TabContent-VB" class="FilteredContentVB">
                <div class="FilteredContentVB TabContainer TabContainerWidget" data-title="Visual Basic" data-itemid="VB">
                    <ul>
                        <li><a href="#TabContent-b8be91a6-324d-4ea8-bce5-ef2a0fcf827e">Visual Basic</a></li>
                    </ul>

                    <div id="TabContent-b8be91a6-324d-4ea8-bce5-ef2a0fcf827e" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">Private</span> <span style="COLOR: #0000ff">Sub</span> cbCodeType_SelectionChanged(sender <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Object</span>, e <span style="COLOR: #0000ff">As</span> SelectionChangedEventArgs)
    <span style="COLOR: #0000ff">If</span> barcode <span style="COLOR: #0000ff">IsNot</span> <span style="COLOR: #0000ff">Nothing</span> <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">Try</span>
            barcode.CodeType = <span style="COLOR: #0000ff">DirectCast</span>(cbCodeType.SelectedItem, CodeType)
            <span style="COLOR: #0000ff">If</span> barcode.CodeType &lt;&gt; CodeType.QRCode <span style="COLOR: #0000ff">OrElse</span> <span style="COLOR: #0000ff">Not</span> Text.Text.Equals(<span style="COLOR: #800000">"http://www.componentone.com"</span>) <span style="COLOR: #0000ff">Then</span>
                Image.Opacity = 1
            <span style="COLOR: #0000ff">Else</span>
                Image.Opacity = 0
            <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
        <span style="COLOR: #0000ff">Catch</span> ex <span style="COLOR: #0000ff">As</span> Exception
            MessageBox.Show(ex.Message)
        <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">Try</span>
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
<span style="COLOR: #0000ff">End Sub</span>
</pre>
                    </div>
                </div>
            </div>

            <div id="TabContent-CS" class="FilteredContentCS">
                <div class="FilteredContentCS TabContainer TabContainerWidget" data-title="C#" data-itemid="CS">
                    <ul>
                        <li><a href="#TabContent-06367a8f-6901-4651-aa93-4cf64ac0e98d">C#</a></li>
                    </ul>

                    <div id="TabContent-06367a8f-6901-4651-aa93-4cf64ac0e98d" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">void</span> cbCodeType_SelectionChanged(<span style="COLOR: #0000ff">object</span> sender, SelectionChangedEventArgs e)
{
    <span style="COLOR: #0000ff">if</span> (barcode != <span style="COLOR: #0000ff">null</span>)
    {
        <span style="COLOR: #0000ff">try</span>
        {
            barcode.CodeType = (CodeType)cbCodeType.SelectedItem;
            <span style="COLOR: #0000ff">if</span> (barcode.CodeType != CodeType.QRCode
                || !text.Text.Equals(<span style="COLOR: #800000">"http://www.componentone.com"</span>))
            {
                image.Opacity = 1;
            }
            <span style="COLOR: #0000ff">else</span>
            {
                image.Opacity = 0;
            }
        }
        <span style="COLOR: #0000ff">catch</span> (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
}
</pre>
                    </div>
                </div>
            </div>
        </div>
    </li>

    <li>Add the following code to the <strong>text_TextChanged</strong> event handler created in Step 2 to enable text change.

        <div class="TabContainer TabContainerWidget">
            <ul>
                <li class="FilteredContentVB"><a href="#TabContent-VB">Visual Basic</a></li>

                <li class="FilteredContentCS"><a href="#TabContent-CS">C#</a></li>
            </ul>

            <div id="TabContent-VB" class="FilteredContentVB">
                <div class="FilteredContentVB TabContainer TabContainerWidget" data-title="Visual Basic" data-itemid="VB">
                    <ul>
                        <li><a href="#TabContent-047aacb3-95d8-41ea-957e-675bee90e2b8">Visual Basic</a></li>
                    </ul>

                    <div id="TabContent-047aacb3-95d8-41ea-957e-675bee90e2b8" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">Private</span> <span style="COLOR: #0000ff">Sub</span> text_TextChanged(sender <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Object</span>, e <span style="COLOR: #0000ff">As</span> TextChangedEventArgs)
    <span style="COLOR: #0000ff">If</span> <span style="COLOR: #0000ff">Not</span> <span style="COLOR: #0000ff">String</span>.IsNullOrEmpty(Text.Text) <span style="COLOR: #0000ff">AndAlso</span> Text.Text.Equals(<span style="COLOR: #800000">"http://www.componentone.com"</span>) <span style="COLOR: #0000ff">AndAlso</span> barcode.CodeType = CodeType.QRCode <span style="COLOR: #0000ff">Then</span>
        Image.Opacity = 1
    <span style="COLOR: #0000ff">Else</span>
        Image.Opacity = 0
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
<span style="COLOR: #0000ff">End Sub</span>
</pre>
                    </div>
                </div>
            </div>

            <div id="TabContent-CS" class="FilteredContentCS">
                <div class="FilteredContentCS TabContainer TabContainerWidget" data-title="C#" data-itemid="CS">
                    <ul>
                        <li><a href="#TabContent-29544a4f-fa9d-41b5-b1b4-1900877403b1">C#</a></li>
                    </ul>

                    <div id="TabContent-29544a4f-fa9d-41b5-b1b4-1900877403b1" class="FilteredContent code">
                        <pre>
<span style="COLOR: #0000ff">void</span> text_TextChanged(<span style="COLOR: #0000ff">object</span> sender, TextChangedEventArgs e)
{
    <span style="COLOR: #0000ff">if</span> (!<span style="COLOR: #0000ff">string</span>.IsNullOrEmpty(text.Text) &amp;&amp;
        text.Text.Equals(<span style="COLOR: #800000">"http://www.componentone.com"</span>) &amp;&amp;
        barcode.CodeType == CodeType.QRCode)
        image.Opacity = 1;
    <span style="COLOR: #0000ff">else</span>
        image.Opacity = 0;
}
</pre>
                    </div>
                </div>
            </div>
        </div>
    </li>
</ol>

<p>With this, you completed adding code to the interaction logic for XAML.</p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
        
    </div>
    <div id="FooterContent">
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
<!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p>Copyright (c) <script type="text/javascript">
var theDate=new Date()
document.write(theDate.getFullYear())
</script> GrapeCity, inc. All rights reserved.

<script>$(document).ready(function() {
  if (!(window.self !== window.top)) {
    // Not running in a frameset
    // Get the page name
    var pageName = location.href.substring(location.href.lastIndexOf("/") + 1);
    if (pageName.indexOf("#") != -1) {
      pageName = pageName.substring(0, pageName.indexOf("#"));
    }
    // Append to webframe.html
    var framePage = "webframe.html#" + pageName;
    location.href = framePage;
  }
});</script></p><!--DXMETADATA end -->
<!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a target="_blank" href="http://our.componentone.com/groups/">Product Support Forum</a>
&nbsp;| &nbsp;<a target="_blank" href="http://feedback.componentone.com/forums/272000-wpf-and-silverlight-documentation">Documentation Feedback</a>
<!--DXMETADATA end-->
    </div>
    
</body>
</html>
